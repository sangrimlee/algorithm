---
title: Construct Binary Search Tree from Preorder Traversal
tags:
  - Array
  - Stack
  - Tree
  - Binary Search Tree
  - Monotonic Stack
  - Binary Tree
---

# 1008. Construct Binary Search Tree from Preorder Traversal

<Badge.Root>
  <Badge.Level level="medium" />
  <Badge.Topic name="Array" slug="array" />
  <Badge.Topic name="Stack" slug="stack" />
  <Badge.Topic name="Tree" slug="tree" />
  <Badge.Topic name="Binary Search Tree" slug="binary-search-tree" />
  <Badge.Topic name="Monotonic Stack" slug="monotonic-stack" />
  <Badge.Topic name="Binary Tree" slug="binary-tree" />
</Badge.Root>

## Solution

```typescript filename="solution.ts" copy
import { TreeNode } from '@algorithm/lib';

export function bstFromPreorder(preorder: number[]): TreeNode | null {
  const stack = preorder.reverse();

  function build(bound: number): TreeNode | null {
    if (stack.length === 0 || bound < stack[stack.length - 1]) {
      return null;
    }
    const node = new TreeNode(stack.pop()!);
    node.left = build(node.val);
    node.right = build(bound);
    return node;
  }

  return build(Number.MAX_SAFE_INTEGER);
}
```

<ProblemLink
  codingSite="leetcode"
  href="https://leetcode.com/problems/construct-binary-search-tree-from-preorder-traversal"
  title="Construct Binary Search Tree from Preorder Traversal"
/>
